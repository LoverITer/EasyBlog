/*!
 * Emoji dialog plugin for Editor.md
 *
 * @file        emoji-dialog.js
 * @author      pandao
 * @version     1.2.0
 * @updateTime  2015-03-08
 * {@link       https://github.com/pandao/editor.md}
 * @license     MIT
 */
(function(){var a=function(d){var f=jQuery;var i="emoji-dialog";var b=0;var g=[];var h=[];var j="editormd-logo";var e=[j,j+"-1x",j+"-2x",j+"-3x",j+"-4x",j+"-5x",j+"-6x",j+"-7x",j+"-8x"];var c={"zh-cn":{toolbar:{emoji:"Emoji 表情"},dialog:{emoji:{title:"Emoji 表情"}}},"zh-tw":{toolbar:{emoji:"Emoji 表情"},dialog:{emoji:{title:"Emoji 表情"}}},en:{toolbar:{emoji:"Emoji"},dialog:{emoji:{title:"Emoji"}}}};d.fn.emojiDialog=function(){var A=this;var t=this.cm;var F=A.settings;if(!F.emoji){alert("settings.emoji == false");return}var y=F.pluginPath+i+"/";var m=this.editor;var n=t.getCursor();var H=t.getSelection();var l=this.classPrefix;f.extend(true,this.lang,c[this.lang.name]);this.setToolbar();var I=this.lang;var q=l+i,E;var p=I.dialog.emoji;var s=['<div class="'+l+'emoji-dialog-box" style="width: 760px;height: 334px;margin-bottom: 8px;overflow: hidden;">','<div class="'+l+'tab"></div>',"</div>"].join("\n");t.focus();if(m.find("."+q).length>0){E=m.find("."+q);h=[];E.find("a").removeClass("selected");this.dialogShowMask(E);this.dialogLockScreen();E.show()}else{E=this.createDialog({name:q,title:p.title,width:800,height:475,mask:F.dialogShowMask,drag:F.dialogDraggable,content:s,lockScreen:F.dialogLockScreen,maskStyle:{opacity:F.dialogMaskOpacity,backgroundColor:F.dialogMaskBgColor},buttons:{enter:[I.buttons.enter,function(){t.replaceSelection(h.join(" "));this.hide().lockScreen(false).hideMask();return false}],cancel:[I.buttons.cancel,function(){this.hide().lockScreen(false).hideMask();return false}]}})}var z=["Github emoji","Twemoji","Font awesome","Editor.md logo"];var k=E.find("."+l+"tab");if(k.html()===""){var o='<ul class="'+l+'tab-head">';for(var D=0;D<4;D++){var r=(D===0)?' class="active"':"";o+="<li"+r+'><a href="javascript:;">'+z[D]+"</a></li>"}o+="</ul>";k.append(o);var w='<div class="'+l+'tab-container">';for(var v=0;v<4;v++){var C=(v===0)?"":"display:none;";w+='<div class="'+l+'tab-box" style="height: 260px;overflow: hidden;overflow-y: auto;'+C+'"></div>'}w+="</div>";k.append(w)}var u=k.find("."+l+"tab-box");var B=["github-emoji","twemoji","font-awesome",j];var G=function(){var M=B[b];var L=g[M];var O=u.eq(b);if(O.html()!==""){return}var K=function(R,X){var V=(X==="editormd-logo")?"5":20;var T=Math.ceil(R.length/V);var aa='<div class="'+l+'grid-table">';for(var S=0;S<T;S++){var ab='<div class="'+l+'grid-table-row">';for(var Z=0;Z<V;Z++){var U=f.trim(R[(S*V)+Z]);if(typeof U!=="undefined"&&U!==""){var Q="",Y="";if(X==="github-emoji"){var P=(U==="+1")?"plus1":U;P=(P==="black_large_square")?"black_square":P;P=(P==="moon")?"waxing_gibbous_moon":P;P=d.emoji.path+P+d.emoji.ext;Q='<img src="'+P+'" width="24" class="emoji" title="&#58;'+U+'&#58;" alt="&#58;'+U+'&#58;" />';ab+='<a href="javascript:;" value=":'+U+':" title=":'+U+':" class="'+l+'emoji-btn">'+Q+"</a>"}else{if(X==="twemoji"){var W=d.twemoji.path+U+d.twemoji.ext;Q='<img src="'+W+'" width="24" title="twemoji-'+U+'" alt="twemoji-'+U+'" class="emoji twemoji" />';ab+='<a href="javascript:;" value=":tw-'+U+':" title=":tw-'+U+':" class="'+l+'emoji-btn">'+Q+"</a>"}else{if(X==="font-awesome"){Y='<i class="fa fa-'+U+' fa-emoji" title="'+U+'"></i>';ab+='<a href="javascript:;" value=":fa-'+U+':" title=":fa-'+U+':" class="'+l+'emoji-btn">'+Y+"</a>"}else{if(X==="editormd-logo"){Y='<i class="'+U+'" title="Editor.md logo ('+U+')"></i>';ab+='<a href="javascript:;" value=":'+U+':" title=":'+U+':" style="width:20%;" class="'+l+'emoji-btn">'+Y+"</a>"}}}}}else{ab+='<a href="javascript:;" value=""></a>'}}ab+="</div>";aa+=ab}aa+="</div>";return aa};if(b===0){for(var N=0,J=L.length;N<J;N++){var x=(N===0)?' style="margin: 0 0 10px;"':' style="margin: 10px 0;"';O.append("<h4"+x+">"+L[N].category+"</h4>");O.append(K(L[N].list,M))}}else{O.append(K(L,M))}O.find("."+l+"emoji-btn").bind(d.mouseOrTouch("click","touchend"),function(){f(this).toggleClass("selected");if(f(this).hasClass("selected")){h.push(f(this).attr("value"))}})};if(g.length<1){if(typeof E.loading==="function"){E.loading(true)}f.getJSON(y+"emoji.json?temp="+Math.random(),function(x){if(typeof E.loading==="function"){E.loading(false)}g=x;g[j]=e;G()})}else{G()}k.find("li").bind(d.mouseOrTouch("click","touchend"),function(){var x=f(this);b=x.index();x.addClass("active").siblings().removeClass("active");u.eq(b).show().siblings().hide();G()})}};if(typeof require==="function"&&typeof exports==="object"&&typeof module==="object"){module.exports=a}else{if(typeof define==="function"){if(define.amd){define(["editormd"],function(b){a(b)})}else{define(function(c){var b=c("./../../editormd");a(b)})}}else{a(window.editormd)}}})();