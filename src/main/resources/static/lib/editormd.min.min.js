/*! Editor.md v1.5.0 | editormd.min.js | Open source online markdown editor. | MIT License | By: Pandao | https://github.com/pandao/editor.md | 2015-06-09 */
;!function(a){"function"==typeof require&&"object"==typeof exports&&"object"==typeof module?module.exports=a:"function"==typeof define?define.amd||define(["jquery"],a):window.editormd=a()}(function(){var g="undefined"!=typeof jQuery?jQuery:Zepto;if("undefined"!=typeof g){var d=function(k,a){return new d.fn.init(k,a)};d.title=d.$name="Editor.md",d.version="1.5.0",d.homePage="https://pandao.github.io/editor.md/",d.classPrefix="editormd-",d.toolbarModes={full:["undo","redo","|","bold","del","italic","quote","ucwords","uppercase","lowercase","|","h1","h2","h3","h4","h5","h6","|","list-ul","list-ol","hr","|","link","reference-link","image","code","preformatted-text","code-block","table","datetime","emoji","html-entities","pagebreak","|","goto-line","watch","preview","fullscreen","clear","search","|","help","info"],simple:["undo","redo","|","bold","del","italic","quote","uppercase","lowercase","|","h1","h2","h3","h4","h5","h6","|","list-ul","list-ol","hr","|","watch","preview","fullscreen","|","help","info"],mini:["undo","redo","|","watch","preview","|","help","info"]},d.defaults={mode:"gfm",name:"",value:"",theme:"",editorTheme:"default",previewTheme:"",markdown:"",appendMarkdown:"",width:"100%",height:"100%",path:"./lib/",pluginPath:"",delay:300,autoLoadModules:!0,watch:!0,placeholder:"Enjoy Markdown! coding now...",gotoLine:!0,codeFold:!1,autoHeight:!1,autoFocus:!0,autoCloseTags:!0,searchReplace:!0,syncScrolling:!0,readOnly:!1,tabSize:4,indentUnit:4,lineNumbers:!0,lineWrapping:!0,autoCloseBrackets:!0,showTrailingSpace:!0,matchBrackets:!0,indentWithTabs:!0,styleSelectedText:!0,matchWordHighlight:!0,styleActiveLine:!0,dialogLockScreen:!0,dialogShowMask:!0,dialogDraggable:!0,dialogMaskBgColor:"#fff",dialogMaskOpacity:0.1,fontSize:"13px",saveHTMLToTextarea:!1,disabledKeyMaps:[],onload:function(){},onresize:function(){},onchange:function(){},onwatch:null,onunwatch:null,onpreviewing:function(){},onpreviewed:function(){},onfullscreen:function(){},onfullscreenExit:function(){},onscroll:function(){},onpreviewscroll:function(){},imageUpload:!1,imageFormats:["jpg","jpeg","gif","png","bmp","webp"],imageUploadURL:"",crossDomainUpload:!1,uploadCallbackURL:"",toc:!0,tocm:!1,tocTitle:"",tocDropdown:!1,tocContainer:"",tocStartLevel:1,htmlDecode:!1,pageBreak:!0,atLink:!0,emailLink:!0,taskList:!1,emoji:!1,tex:!1,flowChart:!1,sequenceDiagram:!1,previewCodeHighlight:!0,toolbar:!0,toolbarAutoFixed:!0,toolbarIcons:"full",toolbarTitles:{},toolbarHandlers:{ucwords:function(){return d.toolbarHandlers.ucwords},lowercase:function(){return d.toolbarHandlers.lowercase}},toolbarCustomIcons:{lowercase:'<a href="javascript:;" title="Lowercase" unselectable="on"><i class="fa" name="lowercase" style="font-size:24px;margin-top: -10px;">a</i></a>',ucwords:'<a href="javascript:;" title="ucwords" unselectable="on"><i class="fa" name="ucwords" style="font-size:20px;margin-top: -3px;">Aa</i></a>'},toolbarIconsClass:{undo:"fa-undo",redo:"fa-repeat",bold:"fa-bold",del:"fa-strikethrough",italic:"fa-italic",quote:"fa-quote-left",uppercase:"fa-font",h1:d.classPrefix+"bold",h2:d.classPrefix+"bold",h3:d.classPrefix+"bold",h4:d.classPrefix+"bold",h5:d.classPrefix+"bold",h6:d.classPrefix+"bold","list-ul":"fa-list-ul","list-ol":"fa-list-ol",hr:"fa-minus",link:"fa-link","reference-link":"fa-anchor",image:"fa-picture-o",code:"fa-code","preformatted-text":"fa-file-code-o","code-block":"fa-file-code-o",table:"fa-table",datetime:"fa-clock-o",emoji:"fa-smile-o","html-entities":"fa-copyright",pagebreak:"fa-newspaper-o","goto-line":"fa-terminal",watch:"fa-eye-slash",unwatch:"fa-eye",preview:"fa-desktop",search:"fa-search",fullscreen:"fa-arrows-alt",clear:"fa-eraser",help:"fa-question-circle",info:"fa-info-circle"},toolbarIconTexts:{},lang:{name:"zh-cn",description:"开源在线Markdown编辑器<br/>Open source online Markdown editor.",tocTitle:"目录",toolbar:{undo:"撤销（Ctrl+Z）",redo:"重做（Ctrl+Y）",bold:"粗体",del:"删除线",italic:"斜体",quote:"引用",ucwords:"将每个单词首字母转成大写",uppercase:"将所选转换成大写",lowercase:"将所选转换成小写",h1:"标题1",h2:"标题2",h3:"标题3",h4:"标题4",h5:"标题5",h6:"标题6","list-ul":"无序列表","list-ol":"有序列表",hr:"横线",link:"链接","reference-link":"引用链接",image:"添加图片",code:"行内代码","preformatted-text":"预格式文本 / 代码块（缩进风格）","code-block":"代码块（多语言风格）",table:"添加表格",datetime:"日期时间",emoji:"Emoji表情","html-entities":"HTML实体字符",pagebreak:"插入分页符","goto-line":"跳转到行",watch:"关闭实时预览",unwatch:"开启实时预览",preview:"全窗口预览HTML（按 Shift + ESC还原）",fullscreen:"全屏（按ESC还原）",clear:"清空",search:"搜索",help:"使用帮助",info:"关于"+d.title},buttons:{enter:"确定",cancel:"取消",close:"关闭"},dialog:{link:{title:"添加链接",url:"链接地址",urlTitle:"链接标题",urlEmpty:"错误：请填写链接地址。"},referenceLink:{title:"添加引用链接",name:"引用名称",url:"链接地址",urlId:"链接ID",urlTitle:"链接标题",nameEmpty:"错误：引用链接的名称不能为空。",idEmpty:"错误：请填写引用链接的ID。",urlEmpty:"错误：请填写引用链接的URL地址。"},image:{title:"添加图片",url:"图片地址",link:"图片链接",alt:"图片描述",uploadButton:"本地上传",imageURLEmpty:"错误：图片地址不能为空。",uploadFileEmpty:"错误：上传的图片不能为空。",formatNotAllowed:"错误：只允许上传图片文件，允许上传的图片文件格式有："},preformattedText:{title:"添加预格式文本或代码块",emptyAlert:"错误：请填写预格式文本或代码的内容。"},codeBlock:{title:"添加代码块",selectLabel:"代码语言：",selectDefaultText:"请选择代码语言",otherLanguage:"其他语言",unselectedLanguageAlert:"错误：请选择代码所属的语言类型。",codeEmptyAlert:"错误：请填写代码内容。"},htmlEntities:{title:"HTML 实体字符"},help:{title:"使用帮助"}}}},d.classNames={tex:d.classPrefix+"tex"},d.dialogZindex=99999,d.$katex=null,d.$marked=null,d.$CodeMirror=null,d.$prettyPrint=null;var c,h;d.prototype=d.fn={state:{watching:!1,loaded:!1,preview:!1,fullscreen:!1},init:function(m,t){t=t||{},"object"==typeof m&&(t=m);var q=this.classPrefix=d.classPrefix,v=this.settings=g.extend(!0,d.defaults,t);m="object"==typeof m?v.id:m;var k=this.editor=g("#"+m);this.id=m,this.lang=v.lang;var p=this.classNames={textarea:{html:q+"html-textarea",markdown:q+"markdown-textarea"}};v.pluginPath=""===v.pluginPath?v.path+"../plugins/":v.pluginPath,this.state.watching=v.watch?!0:!1,k.hasClass("editormd")||k.addClass("editormd"),k.css({width:"number"==typeof v.width?v.width+"px":v.width,height:"number"==typeof v.height?v.height+"px":v.height}),v.autoHeight&&k.css("height","auto");var e=this.markdownTextarea=k.children("textarea");e.length<1&&(k.append("<textarea></textarea>"),e=this.markdownTextarea=k.children("textarea")),e.addClass(p.textarea.markdown).attr("placeholder",v.placeholder),("undefined"==typeof e.attr("name")||""===e.attr("name"))&&e.attr("name",""!==v.name?v.name:m+"-markdown-doc");var u=[v.readOnly?"":'<a href="javascript:;" class="fa fa-close '+q+'preview-close-btn"></a>',v.saveHTMLToTextarea?'<textarea class="'+p.textarea.html+'" name="'+m+'-html-code"></textarea>':"",'<div class="'+q+'preview"><div class="markdown-body '+q+'preview-container"></div></div>','<div class="'+q+'container-mask" style="display:block;"></div>','<div class="'+q+'mask"></div>'].join("\n");return k.append(u).addClass(q+"vertical"),""!==v.theme&&k.addClass(q+"theme-"+v.theme),this.mask=k.children("."+q+"mask"),this.containerMask=k.children("."+q+"container-mask"),""!==v.markdown&&e.val(v.markdown),""!==v.appendMarkdown&&e.val(e.val()+v.appendMarkdown),this.htmlTextarea=k.children("."+p.textarea.html),this.preview=k.children("."+q+"preview"),this.previewContainer=this.preview.children("."+q+"preview-container"),""!==v.previewTheme&&this.preview.addClass(q+"preview-theme-"+v.previewTheme),"function"==typeof define&&define.amd&&("undefined"!=typeof katex&&(d.$katex=katex),v.searchReplace&&!v.readOnly&&(d.loadCSS(v.path+"codemirror/addon/dialog/dialog"),d.loadCSS(v.path+"codemirror/addon/search/matchesonscrollbar"))),"function"==typeof define&&define.amd||!v.autoLoadModules?("undefined"!=typeof CodeMirror&&(d.$CodeMirror=CodeMirror),"undefined"!=typeof marked&&(d.$marked=marked),this.setCodeMirror().setToolbar().loadedDisplay()):this.loadQueues(),this},loadQueues:function(){var l=this,a=this.settings,m=a.path,k=function(){return d.isIE8?void l.loadedDisplay():void (a.flowChart||a.sequenceDiagram?d.loadScript(m+"raphael.min",function(){d.loadScript(m+"underscore.min",function(){!a.flowChart&&a.sequenceDiagram?d.loadScript(m+"sequence-diagram.min",function(){l.loadedDisplay()}):a.flowChart&&!a.sequenceDiagram?d.loadScript(m+"flowchart.min",function(){d.loadScript(m+"jquery.flowchart.min",function(){l.loadedDisplay()})}):a.flowChart&&a.sequenceDiagram&&d.loadScript(m+"flowchart.min",function(){d.loadScript(m+"jquery.flowchart.min",function(){d.loadScript(m+"sequence-diagram.min",function(){l.loadedDisplay()})})})})}):l.loadedDisplay())};return d.loadCSS(m+"codemirror/codemirror.min"),a.searchReplace&&!a.readOnly&&(d.loadCSS(m+"codemirror/addon/dialog/dialog"),d.loadCSS(m+"codemirror/addon/search/matchesonscrollbar")),a.codeFold&&d.loadCSS(m+"codemirror/addon/fold/foldgutter"),d.loadScript(m+"codemirror/codemirror.min",function(){d.$CodeMirror=CodeMirror,d.loadScript(m+"codemirror/modes.min",function(){d.loadScript(m+"codemirror/addons.min",function(){return l.setCodeMirror(),"gfm"!==a.mode&&"markdown"!==a.mode?(l.loadedDisplay(),!1):(l.setToolbar(),void d.loadScript(m+"marked.min",function(){d.$marked=marked,a.previewCodeHighlight?d.loadScript(m+"prettify.min",function(){k()}):k()}))})})}),this},setTheme:function(l){var k=this.editor,a=this.settings.theme,m=this.classPrefix+"theme-";return k.removeClass(m+a).addClass(m+l),this.settings.theme=l,this},setEditorTheme:function(k){var a=this.settings;return a.editorTheme=k,"default"!==k&&d.loadCSS(a.path+"codemirror/theme/"+a.editorTheme),this.cm.setOption("theme",k),this},setCodeMirrorTheme:function(a){return this.setEditorTheme(a),this},setPreviewTheme:function(l){var k=this.preview,a=this.settings.previewTheme,m=this.classPrefix+"preview-theme-";return k.removeClass(m+a).addClass(m+l),this.settings.previewTheme=l,this},setCodeMirror:function(){var k=this.settings,a=this.editor;"default"!==k.editorTheme&&d.loadCSS(k.path+"codemirror/theme/"+k.editorTheme);var l={mode:k.mode,theme:k.editorTheme,tabSize:k.tabSize,dragDrop:!1,autofocus:k.autoFocus,autoCloseTags:k.autoCloseTags,readOnly:k.readOnly?"nocursor":!1,indentUnit:k.indentUnit,lineNumbers:k.lineNumbers,lineWrapping:k.lineWrapping,extraKeys:{"Ctrl-Q":function(i){i.foldCode(i.getCursor())}},foldGutter:k.codeFold,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"],matchBrackets:k.matchBrackets,indentWithTabs:k.indentWithTabs,styleActiveLine:k.styleActiveLine,styleSelectedText:k.styleSelectedText,autoCloseBrackets:k.autoCloseBrackets,showTrailingSpace:k.showTrailingSpace,highlightSelectionMatches:k.matchWordHighlight?{showToken:"onselected"===k.matchWordHighlight?!1:/\w/}:!1};return this.codeEditor=this.cm=d.$CodeMirror.fromTextArea(this.markdownTextarea[0],l),this.codeMirror=this.cmElement=a.children(".CodeMirror"),""!==k.value&&this.cm.setValue(k.value),this.codeMirror.css({fontSize:k.fontSize,width:k.watch?"50%":"100%"}),k.autoHeight&&(this.codeMirror.css("height","auto"),this.cm.setOption("viewportMargin",1/0)),k.lineNumbers||this.codeMirror.find(".CodeMirror-gutters").css("border-right","none"),this},getCodeMirrorOption:function(a){return this.cm.getOption(a)},setCodeMirrorOption:function(i,a){return this.cm.setOption(i,a),this},addKeyMap:function(i,a){return this.cm.addKeyMap(i,a),this},removeKeyMap:function(a){return this.cm.removeKeyMap(a),this},gotoLine:function(A){var q=this.settings;if(!q.gotoLine){return this}var k=this.cm,e=(this.editor,k.lineCount()),m=this.preview;if("string"==typeof A&&("last"===A&&(A=e),"first"===A&&(A=1)),"number"!=typeof A){return alert("Error: The line number must be an integer."),this}if(A=parseInt(A)-1,A>e){return alert("Error: The line number range 1-"+e),this}k.setCursor({line:A,ch:0});var y=k.getScrollInfo(),B=y.clientHeight,p=k.charCoords({line:A,ch:0},"local");if(k.scrollTo(null,(p.top+p.bottom-B)/2),q.watch){var x=this.codeMirror.find(".CodeMirror-scroll")[0],v=g(x).height(),w=x.scrollTop,z=w/x.scrollHeight;m.scrollTop(0===w?0:w+v>=x.scrollHeight-16?m[0].scrollHeight:m[0].scrollHeight*z)}return k.focus(),this},extend:function(){return"undefined"!=typeof arguments[1]&&("function"==typeof arguments[1]&&(arguments[1]=g.proxy(arguments[1],this)),this[arguments[0]]=arguments[1]),"object"==typeof arguments[0]&&"undefined"==typeof arguments[0].length&&g.extend(!0,this,arguments[0]),this},set:function(e,a){return"undefined"!=typeof a&&"function"==typeof a&&(a=g.proxy(a,this)),this[e]=a,this},config:function(e,a){var k=this.settings;return"object"==typeof e&&(k=g.extend(!0,k,e)),"string"==typeof e&&(k[e]=a),this.settings=k,this.recreate(),this},on:function(e,a){var k=this.settings;return"undefined"!=typeof k["on"+e]&&(k["on"+e]=g.proxy(a,this)),this},off:function(i){var a=this.settings;return"undefined"!=typeof a["on"+i]&&(a["on"+i]=function(){}),this},showToolbar:function(e){var a=this.settings;return a.readOnly?this:(a.toolbar&&(this.toolbar.length<1||""===this.toolbar.find("."+this.classPrefix+"menu").html())&&this.setToolbar(),a.toolbar=!0,this.toolbar.show(),this.resize(),g.proxy(e||function(){},this)(),this)},hideToolbar:function(e){var a=this.settings;return a.toolbar=!1,this.toolbar.hide(),this.resize(),g.proxy(e||function(){},this)(),this},setToolbarAutoFixed:function(l){var k=this.state,p=this.editor,m=this.toolbar,q=this.settings;"undefined"!=typeof l&&(q.toolbarAutoFixed=l);var e=function(){var n=g(window),a=n.scrollTop();return q.toolbarAutoFixed?void m.css(a-p.offset().top>10&&a<p.height()?{position:"fixed",width:p.width()+"px",left:(n.width()-p.width())/2+"px"}:{position:"absolute",width:"100%",left:0}):!1};return !k.fullscreen&&!k.preview&&q.toolbar&&q.toolbarAutoFixed&&g(window).bind("scroll",e),this},setToolbar:function(){var I=this.settings;if(I.readOnly){return this}var E=this.editor,A=(this.preview,this.classPrefix),y=this.toolbar=E.children("."+A+"toolbar");if(I.toolbar&&y.length<1){var B='<div class="'+A+'toolbar"><div class="'+A+'toolbar-container"><ul class="'+A+'menu"></ul></div></div>';E.append(B),y=this.toolbar=E.children("."+A+"toolbar")}if(!I.toolbar){return y.hide(),this}y.show();for(var L="function"==typeof I.toolbarIcons?I.toolbarIcons():"string"==typeof I.toolbarIcons?d.toolbarModes[I.toolbarIcons]:I.toolbarIcons,x=y.find("."+this.classPrefix+"menu"),D="",K=!1,F=0,J=L.length;J>F;F++){var t=L[F];if("||"===t){K=!0}else{if("|"===t){D+='<li class="divider" unselectable="on">|</li>'}else{var H=/h(\d)/.test(t),G=t;"watch"!==t||I.watch||(G="unwatch");var z=I.lang.toolbar[G],C=I.toolbarIconTexts[G],k=I.toolbarIconsClass[G];z="undefined"==typeof z?"":z,C="undefined"==typeof C?"":C,k="undefined"==typeof k?"":k;var q=K?'<li class="pull-right">':"<li>";"undefined"!=typeof I.toolbarCustomIcons[t]&&"function"!=typeof I.toolbarCustomIcons[t]?q+=I.toolbarCustomIcons[t]:(q+='<a href="javascript:;" title="'+z+'" unselectable="on">',q+='<i class="fa '+k+'" name="'+t+'" unselectable="on">'+(H?t.toUpperCase():""===k?C:"")+"</i>",q+="</a>"),q+="</li>",D=K?q+D:D+q}}}return x.html(D),x.find('[title="Lowercase"]').attr("title",I.lang.toolbar.lowercase),x.find('[title="ucwords"]').attr("title",I.lang.toolbar.ucwords),this.setToolbarHandler(),this.setToolbarAutoFixed(),this},dialogLockScreen:function(){return g.proxy(d.dialogLockScreen,this)(),this},dialogShowMask:function(a){return g.proxy(d.dialogShowMask,this)(a),this},getToolbarHandles:function(k){var a=this.toolbarHandlers=d.toolbarHandlers;return k&&"undefined"!=typeof toolbarIconHandlers[k]?a[k]:a},setToolbarHandler:function(){var m=this,t=this.settings;if(!t.toolbar||t.readOnly){return this}var q=this.toolbar,u=this.cm,k=this.classPrefix,p=this.toolbarIcons=q.find("."+k+"menu > li > a"),e=this.getToolbarHandles();return p.bind(d.mouseOrTouch("click","touchend"),function(l){var o=g(this).children(".fa"),i=o.attr("name"),n=u.getCursor(),v=u.getSelection();return""!==i?(m.activeIcon=o,"undefined"!=typeof e[i]?g.proxy(e[i],m)(u):"undefined"!=typeof t.toolbarHandlers[i]&&g.proxy(t.toolbarHandlers[i],m)(u,o,n,v),"link"!==i&&"reference-link"!==i&&"image"!==i&&"code-block"!==i&&"preformatted-text"!==i&&"watch"!==i&&"preview"!==i&&"search"!==i&&"fullscreen"!==i&&"info"!==i&&u.focus(),!1):void 0}),this},createDialog:function(a){return g.proxy(d.createDialog,this)(a)},createInfoDialog:function(){var l=this,a=this.editor,m=this.classPrefix,k=['<div class="'+m+"dialog "+m+'dialog-info" style="">','<div class="'+m+'dialog-container">','<h1><i class="editormd-logo editormd-logo-lg editormd-logo-color"></i> '+d.title+"<small>v"+d.version+"</small></h1>","<p>"+this.lang.description+"</p>",'<p style="margin: 10px 0 20px 0;"><a href="'+d.homePage+'" target="_blank">'+d.homePage+' <i class="fa fa-external-link"></i></a></p>','<p style="font-size: 0.85em;">Copyright &copy; 2015 <a href="https://github.com/pandao" target="_blank" class="hover-link">Pandao</a>, The <a href="https://github.com/pandao/editor.md/blob/master/LICENSE" target="_blank" class="hover-link">MIT</a> License.</p>',"</div>",'<a href="javascript:;" class="fa fa-close '+m+'dialog-close"></a>',"</div>"].join("\n");a.append(k);var p=this.infoDialog=a.children("."+m+"dialog-info");return p.find("."+m+"dialog-close").bind(d.mouseOrTouch("click","touchend"),function(){l.hideInfoDialog()}),p.css("border",d.isIE8?"1px solid #ddd":"").css("z-index",d.dialogZindex).show(),this.infoDialogPosition(),this},infoDialogPosition:function(){var e=this.infoDialog,a=function(){e.css({top:(g(window).height()-e.height())/2+"px",left:(g(window).width()-e.width())/2+"px"})};return a(),g(window).resize(a),this},showInfoDialog:function(){g("html,body").css("overflow-x","hidden");var a=this.editor,k=this.settings,e=this.infoDialog=a.children("."+this.classPrefix+"dialog-info");return e.length<1&&this.createInfoDialog(),this.lockScreen(!0),this.mask.css({opacity:k.dialogMaskOpacity,backgroundColor:k.dialogMaskBgColor}).show(),e.css("z-index",d.dialogZindex).show(),this.infoDialogPosition(),this},hideInfoDialog:function(){return g("html,body").css("overflow-x",""),this.infoDialog.hide(),this.mask.hide(),this.lockScreen(!1),this},lockScreen:function(a){return d.lockScreen(a),this.resize(),this},recreate:function(){var i=this.editor,a=this.settings;return this.codeMirror.remove(),this.setCodeMirror(),a.readOnly||(i.find(".editormd-dialog").length>0&&i.find(".editormd-dialog").remove(),a.toolbar&&(this.getToolbarHandles(),this.setToolbar())),this.loadedDisplay(!0),this},previewCodeHighlight:function(){var i=this.settings,a=this.previewContainer;return i.previewCodeHighlight&&(a.find("pre").addClass("prettyprint linenums"),"undefined"!=typeof prettyPrint&&prettyPrint()),this},katexRender:function(){return null===c?this:(this.previewContainer.find("."+d.classNames.tex).each(function(){var a=g(this);d.$katex.render(a.text(),a[0]),a.find(".katex").css("font-size","1.6em")}),this)},flowChartAndSequenceDiagramRender:function(){var o=this,e=this.settings,k=this.previewContainer;if(d.isIE8){return this}if(e.flowChart){if(null===h){return this}k.find(".flowchart").flowChart()}e.sequenceDiagram&&k.find(".sequence-diagram").sequenceDiagram({theme:"simple"});var w=o.preview,y=o.codeMirror,m=y.find(".CodeMirror-scroll"),v=m.height(),p=m.scrollTop(),t=p/m[0].scrollHeight,x=0;w.find(".markdown-toc-list").each(function(){x+=g(this).height()});var q=w.find(".editormd-toc-menu").height();return q=q?q:0,w.scrollTop(0===p?0:p+v>=m[0].scrollHeight-16?w[0].scrollHeight:(w[0].scrollHeight+x+q)*t),this},registerKeyMaps:function(q){var k=this,e=this.cm,m=this.settings,y=d.toolbarHandlers,A=m.disabledKeyMaps;if(q=q||null){for(var p in q){if(g.inArray(p,A)<0){var x={};x[p]=q[p],e.addKeyMap(q)}}}else{for(var t in d.keyMaps){var w=d.keyMaps[t],z="string"==typeof w?g.proxy(y[w],k):g.proxy(w,k);if(g.inArray(t,["F9","F10","F11"])<0&&g.inArray(t,A)<0){var v={};v[t]=z,e.addKeyMap(v)}}g(window).keydown(function(l){var a={120:"F9",121:"F10",122:"F11"};if(g.inArray(a[l.keyCode],A)<0){switch(l.keyCode){case 120:return g.proxy(y.watch,k)(),!1;case 121:return g.proxy(y.preview,k)(),!1;case 122:return g.proxy(y.fullscreen,k)(),!1}}})}return this},bindScrollEvent:function(){var q=this,k=this.preview,e=this.settings,m=this.codeMirror,v=d.mouseOrTouch;if(!e.syncScrolling){return this}var w=function(){m.find(".CodeMirror-scroll").bind(v("scroll","touchmove"),function(r){var z=g(this).height(),o=g(this).scrollTop(),x=o/g(this)[0].scrollHeight,i=0;k.find(".markdown-toc-list").each(function(){i+=g(this).height()});var y=k.find(".editormd-toc-menu").height();y=y?y:0,k.scrollTop(0===o?0:o+z>=g(this)[0].scrollHeight-16?k[0].scrollHeight:(k[0].scrollHeight+i+y)*x),g.proxy(e.onscroll,q)(r)})},p=function(){m.find(".CodeMirror-scroll").unbind(v("scroll","touchmove"))},u=function(){k.bind(v("scroll","touchmove"),function(r){var y=g(this).height(),n=g(this).scrollTop(),x=n/g(this)[0].scrollHeight,i=m.find(".CodeMirror-scroll");i.scrollTop(0===n?0:n+y>=g(this)[0].scrollHeight?i[0].scrollHeight:i[0].scrollHeight*x),g.proxy(e.onpreviewscroll,q)(r)})},t=function(){k.unbind(v("scroll","touchmove"))};return m.bind({mouseover:w,mouseout:p,touchstart:w,touchend:p}),"single"===e.syncScrolling?this:(k.bind({mouseover:u,mouseout:t,touchstart:u,touchend:t}),this)},bindChangeEvent:function(){var i=this,a=this.cm,k=this.settings;return k.syncScrolling?(a.on("change",function(e,l){k.watch&&i.previewContainer.css("padding",k.autoHeight?"20px 20px 50px 40px":"20px"),c=setTimeout(function(){clearTimeout(c),i.save(),c=null},k.delay)}),this):this},loadedDisplay:function(e){e=e||!1;var a=this,l=this.editor,k=this.preview,m=this.settings;return this.containerMask.hide(),this.save(),m.watch&&k.show(),l.data("oldWidth",l.width()).data("oldHeight",l.height()),this.resize(),this.registerKeyMaps(),g(window).resize(function(){a.resize()}),this.bindScrollEvent().bindChangeEvent(),e||g.proxy(m.onload,this)(),this.state.loaded=!0,this},width:function(a){return this.editor.css("width","number"==typeof a?a+"px":a),this.resize(),this},height:function(a){return this.editor.css("height","number"==typeof a?a+"px":a),this.resize(),this},resize:function(w,q){w=w||null,q=q||null;var k=this.state,e=this.editor,m=this.preview,v=this.toolbar,x=this.settings,p=this.codeMirror;if(w&&e.css("width","number"==typeof w?w+"px":w),!x.autoHeight||k.fullscreen||k.preview?(q&&e.css("height","number"==typeof q?q+"px":q),k.fullscreen&&e.height(g(window).height()),x.toolbar&&!x.readOnly?p.css("margin-top",v.height()+1).height(e.height()-v.height()):p.css("margin-top",0).height(e.height())):(e.css("height","auto"),p.css("height","auto")),x.watch){if(p.width(e.width()/2),m.width(k.preview?e.width():e.width()/2),this.previewContainer.css("padding",x.autoHeight?"20px 20px 50px 40px":"20px"),x.toolbar&&!x.readOnly?m.css("top",v.height()+1):m.css("top",0),!x.autoHeight||k.fullscreen||k.preview){var u=x.toolbar&&!x.readOnly?e.height()-v.height():e.height();m.height(u)}else{m.height("")}}else{p.width(e.width()),m.hide()}return k.loaded&&g.proxy(x.onresize,this)(),this},save:function(){if(null===c){return this}var e=this,k=this.state,z=this.settings,B=this.cm,q=B.getValue(),y=this.previewContainer;if("gfm"!==z.mode&&"markdown"!==z.mode){return this.markdownTextarea.val(q),this}var t=d.$marked,x=this.markdownToC=[],A=this.markedRendererOptions={toc:z.toc,tocm:z.tocm,tocStartLevel:z.tocStartLevel,pageBreak:z.pageBreak,taskList:z.taskList,emoji:z.emoji,tex:z.tex,atLink:z.atLink,emailLink:z.emailLink,flowChart:z.flowChart,sequenceDiagram:z.sequenceDiagram,previewCodeHighlight:z.previewCodeHighlight},w=this.markedOptions={renderer:d.markedRenderer(x,A),gfm:!0,tables:!0,breaks:!0,pedantic:!1,sanitize:z.htmlDecode?!1:!0,smartLists:!0,smartypants:!0};t.setOptions(w);var v=d.$marked(q,w);if(v=d.filterHTMLTags(v,z.htmlDecode),this.markdownTextarea.text(q),B.save(),z.saveHTMLToTextarea&&this.htmlTextarea.text(v),z.watch||!z.watch&&k.preview){if(y.html(v),this.previewCodeHighlight(),z.toc){var i=""===z.tocContainer?y:g(z.tocContainer),o=i.find("."+this.classPrefix+"toc-menu");i.attr("previewContainer",""===z.tocContainer?"true":"false"),""!==z.tocContainer&&o.length>0&&o.remove(),d.markdownToCRenderer(x,i,z.tocDropdown,z.tocStartLevel),(z.tocDropdown||i.find("."+this.classPrefix+"toc-menu").length>0)&&d.tocDropdownMenu(i,""!==z.tocTitle?z.tocTitle:this.lang.tocTitle),""!==z.tocContainer&&y.find(".markdown-toc").css("border","none")}z.tex&&(!d.kaTeXLoaded&&z.autoLoadModules?d.loadKaTeX(function(){d.$katex=katex,d.kaTeXLoaded=!0,e.katexRender()}):(d.$katex=katex,this.katexRender())),(z.flowChart||z.sequenceDiagram)&&(h=setTimeout(function(){clearTimeout(h),e.flowChartAndSequenceDiagramRender(),h=null},10)),k.loaded&&g.proxy(z.onchange,this)()}return this},focus:function(){return this.cm.focus(),this},setCursor:function(a){return this.cm.setCursor(a),this},getCursor:function(){return this.cm.getCursor()},setSelection:function(i,a){return this.cm.setSelection(i,a),this},getSelection:function(){return this.cm.getSelection()},setSelections:function(a){return this.cm.setSelections(a),this},getSelections:function(){return this.cm.getSelections()},replaceSelection:function(a){return this.cm.replaceSelection(a),this},insertValue:function(a){return this.replaceSelection(a),this},appendMarkdown:function(i){var a=(this.settings,this.cm);return a.setValue(a.getValue()+i),this},setMarkdown:function(a){return this.cm.setValue(a||this.settings.markdown),this},getMarkdown:function(){return this.cm.getValue()},getValue:function(){return this.cm.getValue()},setValue:function(a){return this.cm.setValue(a),this},clear:function(){return this.cm.setValue(""),this},getHTML:function(){return this.settings.saveHTMLToTextarea?this.htmlTextarea.val():(alert("Error: settings.saveHTMLToTextarea == false"),!1)},getTextareaSavedHTML:function(){return this.getHTML()},getPreviewedHTML:function(){return this.settings.watch?this.previewContainer.html():(alert("Error: settings.watch == false"),!1)},watch:function(i){var l=this.settings;if(g.inArray(l.mode,["gfm","markdown"])<0){return this}if(this.state.watching=l.watch=!0,this.preview.show(),this.toolbar){var k=l.toolbarIconsClass.watch,m=l.toolbarIconsClass.unwatch,e=this.toolbar.find(".fa[name=watch]");e.parent().attr("title",l.lang.toolbar.watch),e.removeClass(m).addClass(k)}return this.codeMirror.css("border-right","1px solid #ddd").width(this.editor.width()/2),c=0,this.save().resize(),l.onwatch||(l.onwatch=i||function(){}),g.proxy(l.onwatch,this)(),this},unwatch:function(e){var a=this.settings;if(this.state.watching=a.watch=!1,this.preview.hide(),this.toolbar){var l=a.toolbarIconsClass.watch,k=a.toolbarIconsClass.unwatch,m=this.toolbar.find(".fa[name=watch]");m.parent().attr("title",a.lang.toolbar.unwatch),m.removeClass(l).addClass(k)}return this.codeMirror.css("border-right","none").width(this.editor.width()),this.resize(),a.onunwatch||(a.onunwatch=e||function(){}),g.proxy(a.onunwatch,this)(),this},show:function(e){e=e||function(){};var a=this;return this.editor.show(0,function(){g.proxy(e,a)()}),this},hide:function(e){e=e||function(){};var a=this;return this.editor.hide(0,function(){g.proxy(e,a)()}),this},previewing:function(){var m=this,t=this.editor,q=this.preview,v=this.toolbar,k=this.settings,p=this.codeMirror,e=this.previewContainer;if(g.inArray(k.mode,["gfm","markdown"])<0){return this}k.toolbar&&v&&(v.toggle(),v.find(".fa[name=preview]").toggleClass("active")),p.toggle();var u=function(a){a.shiftKey&&27===a.keyCode&&m.previewed()};"none"===p.css("display")?(this.state.preview=!0,this.state.fullscreen&&q.css("background","#fff"),t.find("."+this.classPrefix+"preview-close-btn").show().bind(d.mouseOrTouch("click","touchend"),function(){m.previewed()}),k.watch?e.css("padding",""):this.save(),e.addClass(this.classPrefix+"preview-active"),q.show().css({position:"",top:0,width:t.width(),height:k.autoHeight&&!this.state.fullscreen?"auto":t.height()}),this.state.loaded&&g.proxy(k.onpreviewing,this)(),g(window).bind("keyup",u)):(g(window).unbind("keyup",u),this.previewed())},previewed:function(){var k=this.editor,p=this.preview,m=this.toolbar,q=this.settings,e=this.previewContainer,l=k.find("."+this.classPrefix+"preview-close-btn");return this.state.preview=!1,this.codeMirror.show(),q.toolbar&&m.show(),p[q.watch?"show":"hide"](),l.hide().unbind(d.mouseOrTouch("click","touchend")),e.removeClass(this.classPrefix+"preview-active"),q.watch&&e.css("padding","20px"),p.css({background:null,position:"absolute",width:k.width()/2,height:q.autoHeight&&!this.state.fullscreen?"auto":k.height()-m.height(),top:q.toolbar?m.height():0}),this.state.loaded&&g.proxy(q.onpreviewed,this)(),this},fullscreen:function(){var l=this,k=this.state,q=this.editor,p=(this.preview,this.toolbar),u=this.settings,e=this.classPrefix+"fullscreen";p&&p.find(".fa[name=fullscreen]").parent().toggleClass("active");var m=function(a){a.shiftKey||27!==a.keyCode||k.fullscreen&&l.fullscreenExit()};return q.hasClass(e)?(g(window).unbind("keyup",m),this.fullscreenExit()):(k.fullscreen=!0,g("html,body").css("overflow","hidden"),q.css({width:g(window).width(),height:g(window).height()}).addClass(e),this.resize(),g.proxy(u.onfullscreen,this)(),g(window).bind("keyup",m)),this},fullscreenExit:function(){var e=this.editor,a=this.settings,l=this.toolbar,k=this.classPrefix+"fullscreen";return this.state.fullscreen=!1,l&&l.find(".fa[name=fullscreen]").parent().removeClass("active"),g("html,body").css("overflow",""),e.css({width:e.data("oldWidth"),height:e.data("oldHeight")}).removeClass(k),this.resize(),g.proxy(a.onfullscreenExit,this)(),this},executePlugin:function(k,m){var l=this,p=this.cm,e=this.settings;return m=e.pluginPath+m,"function"==typeof define?"undefined"==typeof this[k]?(alert("Error: "+k+" plugin is not found, you are not load this plugin."),this):(this[k](p),this):(g.inArray(m,d.loadFiles.plugin)<0?d.loadPlugin(m,function(){d.loadPlugins[k]=l[k],l[k](p)}):g.proxy(d.loadPlugins[k],this)(p),this)},search:function(i){var a=this.settings;return a.searchReplace?(a.readOnly||this.cm.execCommand(i||"find"),this):(alert("Error: settings.searchReplace == false"),this)},searchReplace:function(){return this.search("replace"),this},searchReplaceAll:function(){return this.search("replaceAll"),this}},d.fn.init.prototype=d.fn,d.dialogLockScreen=function(){var a=this.settings||{dialogLockScreen:!0};a.dialogLockScreen&&(g("html,body").css("overflow","hidden"),this.resize())},d.dialogShowMask=function(e){var a=this.editor,k=this.settings||{dialogShowMask:!0};e.css({top:(g(window).height()-e.height())/2+"px",left:(g(window).width()-e.width())/2+"px"}),k.dialogShowMask&&a.children("."+this.classPrefix+"mask").css("z-index",parseInt(e.css("z-index"))-1).show()},d.toolbarHandlers={undo:function(){this.cm.undo()},redo:function(){this.cm.redo()},bold:function(){var l=this.cm,k=l.getCursor(),a=l.getSelection();l.replaceSelection("**"+a+"**"),""===a&&l.setCursor(k.line,k.ch+2)},del:function(){var l=this.cm,k=l.getCursor(),a=l.getSelection();l.replaceSelection("~~"+a+"~~"),""===a&&l.setCursor(k.line,k.ch+2)},italic:function(){var l=this.cm,k=l.getCursor(),a=l.getSelection();l.replaceSelection("*"+a+"*"),""===a&&l.setCursor(k.line,k.ch+1)},quote:function(){var l=this.cm,k=l.getCursor(),a=l.getSelection();0!==k.ch?(l.setCursor(k.line,0),l.replaceSelection("> "+a),l.setCursor(k.line,k.ch+2)):l.replaceSelection("> "+a)},ucfirst:function(){var k=this.cm,a=k.getSelection(),l=k.listSelections();k.replaceSelection(d.firstUpperCase(a)),k.setSelections(l)},ucwords:function(){var k=this.cm,a=k.getSelection(),l=k.listSelections();k.replaceSelection(d.wordsFirstUpperCase(a)),k.setSelections(l)},uppercase:function(){var l=this.cm,k=l.getSelection(),a=l.listSelections();l.replaceSelection(k.toUpperCase()),l.setSelections(a)},lowercase:function(){var l=this.cm,k=(l.getCursor(),l.getSelection()),a=l.listSelections();l.replaceSelection(k.toLowerCase()),l.setSelections(a)},h1:function(){var l=this.cm,k=l.getCursor(),a=l.getSelection();0!==k.ch?(l.setCursor(k.line,0),l.replaceSelection("# "+a),l.setCursor(k.line,k.ch+2)):l.replaceSelection("# "+a)},h2:function(){var l=this.cm,k=l.getCursor(),a=l.getSelection();0!==k.ch?(l.setCursor(k.line,0),l.replaceSelection("## "+a),l.setCursor(k.line,k.ch+3)):l.replaceSelection("## "+a)},h3:function(){var l=this.cm,k=l.getCursor(),a=l.getSelection();0!==k.ch?(l.setCursor(k.line,0),l.replaceSelection("### "+a),l.setCursor(k.line,k.ch+4)):l.replaceSelection("### "+a)},h4:function(){var l=this.cm,k=l.getCursor(),a=l.getSelection();0!==k.ch?(l.setCursor(k.line,0),l.replaceSelection("#### "+a),l.setCursor(k.line,k.ch+5)):l.replaceSelection("#### "+a)},h5:function(){var l=this.cm,k=l.getCursor(),a=l.getSelection();0!==k.ch?(l.setCursor(k.line,0),l.replaceSelection("##### "+a),l.setCursor(k.line,k.ch+6)):l.replaceSelection("##### "+a)},h6:function(){var l=this.cm,k=l.getCursor(),a=l.getSelection();0!==k.ch?(l.setCursor(k.line,0),l.replaceSelection("###### "+a),l.setCursor(k.line,k.ch+7)):l.replaceSelection("###### "+a)},"list-ul":function(){var m=this.cm,k=(m.getCursor(),m.getSelection());if(""===k){m.replaceSelection("- "+k)}else{for(var a=k.split("\n"),n=0,l=a.length;l>n;n++){a[n]=""===a[n]?"":"- "+a[n]}m.replaceSelection(a.join("\n"))}},"list-ol":function(){var m=this.cm,k=(m.getCursor(),m.getSelection());if(""===k){m.replaceSelection("1. "+k)}else{for(var a=k.split("\n"),n=0,l=a.length;l>n;n++){a[n]=""===a[n]?"":n+1+". "+a[n]}m.replaceSelection(a.join("\n"))}},hr:function(){var i=this.cm,a=i.getCursor();i.getSelection();i.replaceSelection((0!==a.ch?"\n\n":"\n")+"------------\n\n")},tex:function(){if(!this.settings.tex){return alert("settings.tex === false"),this}var l=this.cm,k=l.getCursor(),a=l.getSelection();l.replaceSelection("$$"+a+"$$"),""===a&&l.setCursor(k.line,k.ch+2)},link:function(){this.executePlugin("linkDialog","link-dialog/link-dialog")},"reference-link":function(){this.executePlugin("referenceLinkDialog","reference-link-dialog/reference-link-dialog")},pagebreak:function(){if(!this.settings.pageBreak){return alert("settings.pageBreak === false"),this}var a=this.cm;a.getSelection();a.replaceSelection("\r\n[========]\r\n")},image:function(){this.executePlugin("imageDialog","image-dialog/image-dialog")},code:function(){var l=this.cm,k=l.getCursor(),a=l.getSelection();l.replaceSelection("`"+a+"`"),""===a&&l.setCursor(k.line,k.ch+1)},"code-block":function(){this.executePlugin("codeBlockDialog","code-block-dialog/code-block-dialog")},"preformatted-text":function(){this.executePlugin("preformattedTextDialog","preformatted-text-dialog/preformatted-text-dialog")},table:function(){this.executePlugin("tableDialog","table-dialog/table-dialog")},datetime:function(){var k=this.cm,a=(k.getSelection(),new Date,this.settings.lang.name),l=d.dateFormat()+" "+d.dateFormat("zh-cn"===a||"zh-tw"===a?"cn-week-day":"week-day");k.replaceSelection(l)},emoji:function(){this.executePlugin("emojiDialog","emoji-dialog/emoji-dialog")},"html-entities":function(){this.executePlugin("htmlEntitiesDialog","html-entities-dialog/html-entities-dialog")},"goto-line":function(){this.executePlugin("gotoLineDialog","goto-line-dialog/goto-line-dialog")},watch:function(){this[this.settings.watch?"unwatch":"watch"]()},preview:function(){this.previewing()},fullscreen:function(){this.fullscreen()},clear:function(){this.clear()},search:function(){this.search()},help:function(){this.executePlugin("helpDialog","help-dialog/help-dialog")},info:function(){this.showInfoDialog()}},d.keyMaps={"Ctrl-1":"h1","Ctrl-2":"h2","Ctrl-3":"h3","Ctrl-4":"h4","Ctrl-5":"h5","Ctrl-6":"h6","Ctrl-B":"bold","Ctrl-D":"datetime","Ctrl-E":function(){var l=this.cm,k=l.getCursor(),a=l.getSelection();return this.settings.emoji?(l.replaceSelection(":"+a+":"),void (""===a&&l.setCursor(k.line,k.ch+1))):void alert("Error: settings.emoji == false")},"Ctrl-Alt-G":"goto-line","Ctrl-H":"hr","Ctrl-I":"italic","Ctrl-K":"code","Ctrl-L":function(){var l=this.cm,k=l.getCursor(),a=l.getSelection(),m=""===a?"":' "'+a+'"';l.replaceSelection("["+a+"]("+m+")"),""===a&&l.setCursor(k.line,k.ch+1)},"Ctrl-U":"list-ul","Shift-Ctrl-A":function(){var l=this.cm,k=l.getCursor(),a=l.getSelection();return this.settings.atLink?(l.replaceSelection("@"+a),void (""===a&&l.setCursor(k.line,k.ch+1))):void alert("Error: settings.atLink == false")},"Shift-Ctrl-C":"code","Shift-Ctrl-Q":"quote","Shift-Ctrl-S":"del","Shift-Ctrl-K":"tex","Shift-Alt-C":function(){var l=this.cm,k=l.getCursor(),a=l.getSelection();l.replaceSelection(["```",a,"```"].join("\n")),""===a&&l.setCursor(k.line,k.ch+3)},"Shift-Ctrl-Alt-C":"code-block","Shift-Ctrl-H":"html-entities","Shift-Alt-H":"help","Shift-Ctrl-E":"emoji","Shift-Ctrl-U":"uppercase","Shift-Alt-U":"ucwords","Shift-Ctrl-Alt-U":"ucfirst","Shift-Alt-L":"lowercase","Shift-Ctrl-I":function(){var l=this.cm,k=l.getCursor(),a=l.getSelection(),m=""===a?"":' "'+a+'"';l.replaceSelection("!["+a+"]("+m+")"),""===a&&l.setCursor(k.line,k.ch+4)},"Shift-Ctrl-Alt-I":"image","Shift-Ctrl-L":"link","Shift-Ctrl-O":"list-ol","Shift-Ctrl-P":"preformatted-text","Shift-Ctrl-T":"table","Shift-Alt-P":"pagebreak",F9:"watch",F10:"preview",F11:"fullscreen"};var f=function(a){return String.prototype.trim?a.trim():a.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")};d.trim=f;var j=function(a){return a.toLowerCase().replace(/\b(\w)|\s(\w)/g,function(i){return i.toUpperCase()})};d.ucwords=d.wordsFirstUpperCase=j;var b=function(a){return a.toLowerCase().replace(/\b(\w)/,function(i){return i.toUpperCase()})};return d.firstUpperCase=d.ucfirst=b,d.urls={atLinkBase:"https://github.com/"},d.regexs={atLink:/@(\w+)/g,email:/(\w+)@(\w+)\.(\w+)\.?(\w+)?/g,emailLink:/(mailto:)?([\w\.\_]+)@(\w+)\.(\w+)\.?(\w+)?/g,emoji:/:([\w\+-]+):/g,emojiDatetime:/(\d{2}:\d{2}:\d{2})/g,twemoji:/:(tw-([\w]+)-?(\w+)?):/g,fontAwesome:/:(fa-([\w]+)(-(\w+)){0,}):/g,editormdLogo:/:(editormd-logo-?(\w+)?):/g,pageBreak:/^\[[=]{8,}\]$/},d.emoji={path:"http://www.emoji-cheat-sheet.com/graphics/emojis/",ext:".png"},d.twemoji={path:"http://twemoji.maxcdn.com/36x36/",ext:".png"},d.markedRenderer=function(v,k){var q={toc:!0,tocm:!1,tocStartLevel:1,pageBreak:!0,atLink:!0,emailLink:!0,taskList:!1,emoji:!1,tex:!1,flowChart:!1,sequenceDiagram:!1},C=g.extend(q,k||{}),F=d.$marked,t=new F.Renderer;v=v||[];var B=d.regexs,x=B.atLink,A=B.emoji,E=B.email,z=B.emailLink,y=B.twemoji,e=B.fontAwesome,r=B.editormdLogo,D=B.pageBreak;return t.emoji=function(m){m=m.replace(d.regexs.emojiDatetime,function(i){return i.replace(/:/g,"&#58;")});var a=m.match(A);if(!a||!C.emoji){return m}for(var n=0,l=a.length;l>n;n++){":+1:"===a[n]&&(a[n]=":\\+1:"),m=m.replace(new RegExp(a[n]),function(N,K){var G=N.match(e),p=N.replace(/:/g,"");if(G){for(var H=0,Q=G.length;Q>H;H++){var U=G[H].replace(/:/g,"");return'<i class="fa '+U+' fa-emoji" title="'+U.replace("fa-","")+'"></i>'}}else{var I=N.match(r),P=N.match(y);if(I){for(var L=0,O=I.length;O>L;L++){var T=I[L].replace(/:/g,"");return'<i class="'+T+'" title="Editor.md logo ('+T+')"></i>'}}else{if(!P){var M="+1"===p?"plus1":p;return M="black_large_square"===M?"black_square":M,M="moon"===M?"waxing_gibbous_moon":M,'<img src="'+d.emoji.path+M+d.emoji.ext+'" class="emoji" title="&#58;'+p+'&#58;" alt="&#58;'+p+'&#58;" />'}for(var R=0,S=P.length;S>R;R++){var J=P[R].replace(/:/g,"").replace("tw-","");return'<img src="'+d.twemoji.path+J+d.twemoji.ext+'" title="twemoji-'+J+'" alt="twemoji-'+J+'" class="emoji twemoji" />'}}}})}return m},t.atLink=function(a){return x.test(a)?(C.atLink&&(a=a.replace(E,function(n,m,l,p){return n.replace(/@/g,"_#_&#64;_#_")}),a=a.replace(x,function(m,l){return'<a href="'+d.urls.atLinkBase+l+'" title="&#64;'+l+'" class="at-link">'+m+"</a>"}).replace(/_#_&#64;_#_/g,"@")),C.emailLink&&(a=a.replace(z,function(m,l,s,p,u){return !l&&g.inArray(u,"jpg|jpeg|png|gif|webp|ico|icon|pdf".split("|"))<0?'<a href="mailto:'+m+'">'+m+"</a>":m})),a):a},t.link=function(p,l,a){if(this.options.sanitize){try{var s=decodeURIComponent(unescape(p)).replace(/[^\w:]/g,"").toLowerCase()}catch(m){return""}if(0===s.indexOf("javascript:")){return""}}var u='<a href="'+p+'"';return x.test(l)||x.test(a)?(l&&(u+=' title="'+l.replace(/@/g,"&#64;")),u+'">'+a.replace(/@/g,"&#64;")+"</a>"):(l&&(u+=' title="'+l+'"'),u+=">"+a+"</a>")},t.heading=function(I,N,i){var m=I,L=/\s*\<a\s*href\=\"(.*)\"\s*([^\>]*)\>(.*)\<\/a\>\s*/;if(L.test(I)){var O=[];I=I.split(/\<a\s*([^\>]+)\>([^\>]*)\<\/a\>/);for(var p=0,K=I.length;K>p;p++){O.push(I[p].replace(/\s*href\=\"(.*)\"\s*/g,""))}I=O.join(" ")}I=f(I);var w=I.toLowerCase().replace(/[^\w]+/g,"-"),J={text:I,level:N,slug:w},M=/^[\u4e00-\u9fa5]+$/.test(I),H=M?escape(I).replace(/\%/g,""):I.toLowerCase().replace(/[^\w]+/g,"-");v.push(J);var G="<h"+N+' id="h'+N+"-"+this.options.headerPrefix+H+'">';return G+='<a name="'+I+'" class="reference-link"></a>',G+='<span class="header-link octicon octicon-link"></span>',G+=this.atLink(L?this.emoji(m):this.emoji(I)),G+="</h"+N+">"},t.pageBreak=function(a){return D.test(a)&&C.pageBreak&&(a='<hr style="page-break-after:always;" class="page-break editormd-page-break" />'),a},t.paragraph=function(w){var m=/\$\$(.*)\$\$/g.test(w),G=/^\$\$(.*)\$\$$/.test(w),u=G?' class="'+d.classNames.tex+'"':"",H=C.tocm?/^(\[TOC\]|\[TOCM\])$/.test(w):/^\[TOC\]$/.test(w),p=/^\[TOCM\]$/.test(w);w=!G&&m?w.replace(/(\$\$([^\$]*)\$\$)+/g,function(n,l){return'<span class="'+d.classNames.tex+'">'+l.replace(/\$/g,"")+"</span>"}):G?w.replace(/\$/g,""):w;var a='<div class="markdown-toc editormd-markdown-toc">'+w+"</div>";return H?p?'<div class="editormd-toc-menu">'+a+"</div><br/>":a:D.test(w)?this.pageBreak(w):"<p"+u+">"+this.atLink(this.emoji(w))+"</p>\n"},t.code=function(l,a,m){return"seq"===a||"sequence"===a?'<div class="sequence-diagram">'+l+"</div>":"flow"===a?'<div class="flowchart">'+l+"</div>":"math"===a||"latex"===a||"katex"===a?'<p class="'+d.classNames.tex+'">'+l+"</p>":F.Renderer.prototype.code.apply(this,arguments)},t.tablecell=function(m,l){var a=l.header?"th":"td",n=l.align?"<"+a+' style="text-align:'+l.align+'">':"<"+a+">";return n+this.atLink(this.emoji(m))+"</"+a+">\n"},t.listitem=function(a){return C.taskList&&/^\s*\[[x\s]\]\s*/.test(a)?(a=a.replace(/^\s*\[\s\]\s*/,'<input type="checkbox" class="task-list-item-checkbox" /> ').replace(/^\s*\[x\]\s*/,'<input type="checkbox" class="task-list-item-checkbox" checked disabled /> '),'<li style="list-style: none;">'+this.atLink(this.emoji(a))+"</li>"):"<li>"+this.atLink(this.emoji(a))+"</li>"},t},d.markdownToCRenderer=function(x,C,v,m){var k="",p=0,A=this.classPrefix;m=m||1;for(var D=0,q=x.length;q>D;D++){var z=x[D].text,w=x[D].level;m>w||(k+=w>p?"":p>w?new Array(p-w+2).join("</ul></li>"):"</ul></li>",k+='<li><a class="toc-level-'+w+'" href="#'+z+'" level="'+w+'">'+z+"</a><ul>",p=w)}var y=C.find(".markdown-toc");if(y.length<1&&"false"===C.attr("previewContainer")){var B='<div class="markdown-toc '+A+'markdown-toc"></div>';B=v?'<div class="'+A+'toc-menu">'+B+"</div>":B,C.html(B),y=C.find(".markdown-toc")}return v&&y.wrap('<div class="'+A+'toc-menu"></div><br/>'),y.html('<ul class="markdown-toc-list"></ul>').children(".markdown-toc-list").html(k.replace(/\r?\n?\<ul\>\<\/ul\>/g,"")),y},d.tocDropdownMenu=function(e,a){a=a||"Table of Contents";var l=400,k=e.find("."+this.classPrefix+"toc-menu");return k.each(function(){var o=g(this),q=o.children(".markdown-toc"),u='<i class="fa fa-angle-down"></i>',m='<a href="javascript:;" class="toc-menu-btn">'+u+a+"</a>",p=q.children("ul"),i=p.find("li");q.append(m),i.first().before("<li><h1>"+a+" "+u+"</h1></li>"),o.mouseover(function(){p.show(),i.each(function(){var s=g(this),n=s.children("ul");if(""===n.html()&&n.remove(),n.length>0&&""!==n.html()){var v=s.children("a").first();v.children(".fa").length<1&&v.append(g(u).css({"float":"right",paddingTop:"4px"}))}s.mouseover(function(){n.css("z-index",l).show(),l+=1}).mouseleave(function(){n.hide()})})}).mouseleave(function(){p.hide()})}),k},d.filterHTMLTags=function(w,q){if("string"!=typeof w&&(w=new String(w)),"string"!=typeof q){return w}for(var k=q.split("|"),e=k[0].split(","),m=k[1],v=0,x=e.length;x>v;v++){var p=e[v];w=w.replace(new RegExp("<s*"+p+"s*([^>]*)>([^>]*)<s*/"+p+"s*>","igm"),"")}if("undefined"!=typeof m){var u=/\<(\w+)\s*([^\>]*)\>([^\>]*)\<\/(\w+)\>/gi;w="*"===m?w.replace(u,function(s,l,a,y,n){return"<"+l+">"+y+"</"+n+">"}):"on*"===m?w.replace(u,function(F,C,z,y,A){var E=g("<"+C+">"+y+"</"+A+">"),G=g(F)[0].attributes,B={};g.each(G,function(i,a){'"'!==a.nodeName&&(B[a.nodeName]=a.nodeValue)}),g.each(B,function(a){0===a.indexOf("on")&&delete B[a]}),E.attr(B);var D="undefined"!=typeof E[1]?g(E[1]).text():"";return E[0].outerHTML+D}):w.replace(u,function(y,n,B,A){var l=m.split(","),z=g(y);return z.html(A),g.each(l,function(a){z.attr(l[a],null)}),z[0].outerHTML})}return w},d.markdownToHTML=function(q,k){var e={gfm:!0,toc:!0,tocm:!1,tocStartLevel:1,tocTitle:"目录",tocDropdown:!1,tocContainer:"",markdown:"",markdownSourceCode:!1,htmlDecode:!1,autoLoadKaTeX:!0,pageBreak:!0,atLink:!0,emailLink:!0,tex:!1,taskList:!1,emoji:!1,flowChart:!1,sequenceDiagram:!1,previewCodeHighlight:!0};d.$marked=marked;var m=g("#"+q),z=m.settings=g.extend(!0,e,k||{}),B=m.find("textarea");B.length<1&&(m.append("<textarea></textarea>"),B=m.find("textarea"));var p=""===z.markdown?B.val():z.markdown,y=[],t={toc:z.toc,tocm:z.tocm,tocStartLevel:z.tocStartLevel,taskList:z.taskList,emoji:z.emoji,tex:z.tex,pageBreak:z.pageBreak,atLink:z.atLink,emailLink:z.emailLink,flowChart:z.flowChart,sequenceDiagram:z.sequenceDiagram,previewCodeHighlight:z.previewCodeHighlight},x={renderer:d.markedRenderer(y,t),gfm:z.gfm,tables:!0,breaks:!0,pedantic:!1,sanitize:z.htmlDecode?!1:!0,smartLists:!0,smartypants:!0};p=new String(p);var A=marked(p,x);A=d.filterHTMLTags(A,z.htmlDecode),z.markdownSourceCode?B.text(p):B.remove(),m.addClass("markdown-body "+this.classPrefix+"html-preview").append(A);var w=""!==z.tocContainer?g(z.tocContainer):m;if(""!==z.tocContainer&&w.attr("previewContainer",!1),z.toc&&(m.tocContainer=this.markdownToCRenderer(y,w,z.tocDropdown,z.tocStartLevel),(z.tocDropdown||m.find("."+this.classPrefix+"toc-menu").length>0)&&this.tocDropdownMenu(m,z.tocTitle),""!==z.tocContainer&&m.find(".editormd-toc-menu, .editormd-markdown-toc").remove()),z.previewCodeHighlight&&(m.find("pre").addClass("prettyprint linenums"),prettyPrint()),d.isIE8||(z.flowChart&&m.find(".flowchart").flowChart(),z.sequenceDiagram&&m.find(".sequence-diagram").sequenceDiagram({theme:"simple"})),z.tex){var v=function(){m.find("."+d.classNames.tex).each(function(){var a=g(this);katex.render(a.html().replace(/&lt;/g,"<").replace(/&gt;/g,">"),a[0]),a.find(".katex").css("font-size","1.6em")})};!z.autoLoadKaTeX||d.$katex||d.kaTeXLoaded?v():this.loadKaTeX(function(){d.$katex=katex,d.kaTeXLoaded=!0,v()})}return m.getMarkdown=function(){return B.val()},m},d.themes=["default","dark"],d.previewThemes=["default","dark"],d.editorThemes=["default","3024-day","3024-night","ambiance","ambiance-mobile","base16-dark","base16-light","blackboard","cobalt","eclipse","elegant","erlang-dark","lesser-dark","mbo","mdn-like","midnight","monokai","neat","neo","night","paraiso-dark","paraiso-light","pastel-on-dark","rubyblue","solarized","the-matrix","tomorrow-night-eighties","twilight","vibrant-ink","xq-dark","xq-light"],d.loadPlugins={},d.loadFiles={js:[],css:[],plugin:[]},d.loadPlugin=function(k,a,l){a=a||function(){},this.loadScript(k,function(){d.loadFiles.plugin.push(k),a()},l)},d.loadCSS=function(l,a,m){m=m||"head",a=a||function(){};var k=document.createElement("link");k.type="text/css",k.rel="stylesheet",k.onload=k.onreadystatechange=function(){d.loadFiles.css.push(l),a()},k.href=l+".css","head"===m?document.getElementsByTagName("head")[0].appendChild(k):document.body.appendChild(k)},d.isIE="Microsoft Internet Explorer"==navigator.appName,d.isIE8=d.isIE&&"8."==navigator.appVersion.match(/8./i),d.loadScript=function(l,a,m){m=m||"head",a=a||function(){};var k=null;k=document.createElement("script"),k.id=l.replace(/[\./]+/g,"-"),k.type="text/javascript",k.src=l+".js",d.isIE8?k.onreadystatechange=function(){k.readyState&&("loaded"===k.readyState||"complete"===k.readyState)&&(k.onreadystatechange=null,d.loadFiles.js.push(l),a())}:k.onload=function(){d.loadFiles.js.push(l),a()},"head"===m?document.getElementsByTagName("head")[0].appendChild(k):document.body.appendChild(k)},d.katexURL={css:"//cdnjs.cloudflare.com/ajax/libs/KaTeX/0.3.0/katex.min",js:"//cdnjs.cloudflare.com/ajax/libs/KaTeX/0.3.0/katex.min"},d.kaTeXLoaded=!1,d.loadKaTeX=function(a){d.loadCSS(d.katexURL.css,function(){d.loadScript(d.katexURL.js,a||function(){})})},d.lockScreen=function(a){g("html,body").css("overflow",a?"hidden":"")},d.createDialog=function(J){var E={name:"",width:420,height:240,title:"",drag:!0,closed:!0,content:"",mask:!0,maskStyle:{backgroundColor:"#fff",opacity:0.1},lockScreen:!0,footer:!0,buttons:!1};J=g.extend(!0,E,J);var C=this,F=this.editor,Q=d.classPrefix,B=(new Date).getTime(),H=""===J.name?Q+"dialog-"+B:J.name,O=d.mouseOrTouch,K='<div class="'+Q+"dialog "+H+'">';""!==J.title&&(K+='<div class="'+Q+'dialog-header"'+(J.drag?' style="cursor: move;"':"")+">",K+='<strong class="'+Q+'dialog-title">'+J.title+"</strong>",K+="</div>"),J.closed&&(K+='<a href="javascript:;" class="fa fa-close '+Q+'dialog-close"></a>'),K+='<div class="'+Q+'dialog-container">'+J.content,(J.footer||"string"==typeof J.footer)&&(K+='<div class="'+Q+'dialog-footer">'+("boolean"==typeof J.footer?"":J.footer)+"</div>"),K+="</div>",K+='<div class="'+Q+"dialog-mask "+Q+'dialog-mask-bg"></div>',K+='<div class="'+Q+"dialog-mask "+Q+'dialog-mask-con"></div>',K+="</div>",F.append(K);var N=F.find("."+H);N.lockScreen=function(a){return J.lockScreen&&(g("html,body").css("overflow",a?"hidden":""),C.resize()),N},N.showMask=function(){return J.mask&&F.find("."+Q+"mask").css(J.maskStyle).css("z-index",d.dialogZindex-1).show(),N},N.hideMask=function(){return J.mask&&F.find("."+Q+"mask").hide(),N},N.loading=function(i){var a=N.find("."+Q+"dialog-mask");return a[i?"show":"hide"](),N},N.lockScreen(!0).showMask(),N.show().css({zIndex:d.dialogZindex,border:d.isIE8?"1px solid #ddd":"",width:"number"==typeof J.width?J.width+"px":J.width,height:"number"==typeof J.height?J.height+"px":J.height});var A=function(){N.css({top:(g(window).height()-N.height())/2+"px",left:(g(window).width()-N.width())/2+"px"})};if(A(),g(window).resize(A),N.children("."+Q+"dialog-close").bind(O("click","touchend"),function(){N.hide().lockScreen(!1).hideMask()}),"object"==typeof J.buttons){var M=N.footer=N.find("."+Q+"dialog-footer");for(var L in J.buttons){var D=J.buttons[L],G=Q+L+"-btn";M.append('<button class="'+Q+"btn "+G+'">'+D[0]+"</button>"),D[1]=g.proxy(D[1],N),M.children("."+G).bind(O("click","touchend"),D[1])}}if(""!==J.title&&J.drag){var t,z,I=N.children("."+Q+"dialog-header");J.mask||I.bind(O("click","touchend"),function(){d.dialogZindex+=2,N.css("z-index",d.dialogZindex)}),I.mousedown(function(a){a=a||window.event,t=a.clientX-parseInt(N[0].style.left),z=a.clientY-parseInt(N[0].style.top),document.onmousemove=e});var P=function(a){a.removeClass(Q+"user-unselect").off("selectstart")},q=function(a){a.addClass(Q+"user-unselect").on("selectstart",function(i){return !1})},e=function(k){k=k||window.event;var a,m,l=parseInt(N[0].style.left),p=parseInt(N[0].style.top);l>=0?l+N.width()<=g(window).width()?a=k.clientX-t:(a=g(window).width()-N.width(),document.onmousemove=null):(a=0,document.onmousemove=null),p>=0?m=k.clientY-z:(m=0,document.onmousemove=null),document.onselectstart=function(){return !1},q(g("body")),q(N),N[0].style.left=a+"px",N[0].style.top=m+"px"};document.onmouseup=function(){P(g("body")),P(N),document.onselectstart=null,document.onmousemove=null},I.touchDraggable=function(){var k=null,a=function(m){var p=m.originalEvent,n=g(this).parent().position();k={x:p.changedTouches[0].pageX-n.left,y:p.changedTouches[0].pageY-n.top}},l=function(m){m.preventDefault();var n=m.originalEvent;g(this).parent().css({top:n.changedTouches[0].pageY-k.y,left:n.changedTouches[0].pageX-k.x})};this.bind("touchstart",a).bind("touchmove",l)},I.touchDraggable()}return d.dialogZindex+=2,N},d.mouseOrTouch=function(l,k){l=l||"click",k=k||"touchend";var a=l;try{document.createEvent("TouchEvent"),a=k}catch(m){}return a},d.dateFormat=function(I){I=I||"";var v=function(a){return 10>a?"0"+a:a},E=new Date,A=E.getFullYear(),y=A.toString().slice(2,4),B=v(E.getMonth()+1),L=v(E.getDate()),x=E.getDay(),D=v(E.getHours()),K=v(E.getMinutes()),F=v(E.getSeconds()),J=v(E.getMilliseconds()),q="",H=y+"-"+B+"-"+L,G=A+"-"+B+"-"+L,z=D+":"+K+":"+F;switch(I){case"UNIX Time":q=E.getTime();break;case"UTC":q=E.toUTCString();break;case"yy":q=y;break;case"year":case"yyyy":q=A;break;case"month":case"mm":q=B;break;case"cn-week-day":case"cn-wd":var C=["日","一","二","三","四","五","六"];q="星期"+C[x];break;case"week-day":case"wd":var k=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];q=k[x];break;case"day":case"dd":q=L;break;case"hour":case"hh":q=D;break;case"min":case"ii":q=K;break;case"second":case"ss":q=F;break;case"ms":q=J;break;case"yy-mm-dd":q=H;break;case"yyyy-mm-dd":q=G;break;case"yyyy-mm-dd h:i:s ms":case"full + ms":q=G+" "+z+" "+J;break;case"full":case"yyyy-mm-dd h:i:s":default:q=G+" "+z}return q},d}});