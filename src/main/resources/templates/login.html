<!doctype html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EasyBlog - Blog for stronger</title>
    <link rel="stylesheet" href="../static/css/styles.css" th:href="@{/static/css/styles.css}">
    <link rel="stylesheet" href="../static/css/jigsaw.css" th:href="@{/static/css/jigsaw.css}">
</head>
<body style="background: url(../static/images/bg.png)">
<div class="jq22-container" style="padding-top:30px">
    <div class="login-wrap">
        <div class="login-html">
            <input id="tab-1" type="radio" name="tab" class="sign-in" checked><label for="tab-1" class="tab">登录</label>
            <input id="tab-2" type="radio" name="tab" class="sign-up"><label for="tab-2" class="tab">注册</label>
            <div class="login-form">
                <form action="#" th:action="@{/login}" method="post">
                    <div class="sign-in-htm">
                        <div class="group">
                            <label class="label">手机号/邮箱</label>
                            <input id="username" name="username" type="text" class="input">
                        </div>
                        <div class="group">
                            <label for="pass" class="label">密码</label>
                            <input id="password" name="password" type="password" class="input" data-type="password">
                        </div>
                        <div class="group">
                            <input id="check1" name="remeber-me" type="checkbox" class="check" checked>
                            <label for="check1" style="font-size: 14px"> <span class="icon"></span> 保持登录</label>
                        </div>
                        <div class="group">
                            <input type="button" class="button" value="登录" onclick="sub()">
                        </div>

                        <div class="foot-lnk">
                            <a href="#forgot">忘记密码?</a>
                        </div>
                    </div>
                </form>
                <form action="#" th:action="@{/register}" method="post">
                    <div class="sign-up-htm">
                        <div class="group">
                            <label class="label">昵称</label>
                            <input id="user-nickname" name="user-nickname" type="text" class="input"
                                   placeholder="给自己起个好听的名字吧">
                        </div>
                        <div class="group">
                            <label class="label">密码</label>
                            <input id="pass" name="user-pwd" type="password" class="input" data-type="password"
                                   placeholder="6-16位字符组成，区分大小写">
                        </div>
                        <div class="group">
                            <label class="label">手机号/邮箱</label>
                            <input id="phone-mail" name="account" type="text" class="input" placeholder="填写常用的手机号或者邮箱">
                        </div>
                        <div class="group">
                            <label class="label">验证码</label>
                            <input id="captcha" type="text" name="captcha-code" class="input" placeholder="请输入验证码">
                            <span id="message"
                                  style="display: none;font-size: 12px;margin-top: 5px"></span>
                        </div>

                        <div class="group">
                            <input id="check2" type="checkbox" class="check">
                            <label for="check2" style="font-size: 14px"><span class="icon"></span> 我已经同意<a href="#"
                                                                                                           style="color: #00a1d6">《EasyBlog用户使用协议》</a></label>
                        </div>
                        <div class="group">
                            <a href="#"><input type="submit" class="button" value="注册"></a>
                        </div>

                        <div class="foot-lnk">
                            <label for="tab-1">已经有账号了?</label>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/jquery@3.2/dist/jquery.min.js"></script>
<script src="../static/js/jigsaw.js" th:href="@{/static/js/jigsaw.js}"></script>
<script>
    var flag = false;

    function sub() {
        var name = document.getElementById('username').value;
        var pass = document.getElementById('password').value;
        var cname = "admin";
        var cpass = "123";
        if (name == cname && pass == cpass && flag == true) {
            alert("登录成功!")
            //window.location.href="#";
        } else {
            if (flag == false) {
                alert("验证失败!")
                return;
            }
            alert("用户名或密码错误!")
        }
    }

    jigsaw.init(document.getElementById('captcha'), function () {
        flag = true;
        document.getElementById('msg').innerHTML = '验证成功！'
    })
</script>
<script type="text/javascript">

    $('#phone-mail').blur(function () {
        var str = $('#phone-mail').val();
        var mail_reg = /\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*/;
        var phone_reg = /^(((13[0-9]{1})|(14[0-9]{1})|(17[0-9]{1})|(15[0-3]{1})|(15[4-9]{1})|(18[0-9]{1})|(199))+\d{8})$/;

        if (phone_reg.test(str)) {
            //判断是手机，就通过ajax异步请求给用户的这个手机发送验证码
            $.ajax({
                url: "/captcha-code2phone",
                type: "GET",
                async: true,
                data: {phone:str},
                dataType: "text",
                success: function () {
                    $('#message').show().css("color", "gray").text("验证码已经发送到您的手机,请注意查收！");
                },
                error: function () {
                    $('#message').show().css("color", "#d0393f").text("服务器异常，请重新输入手机号！");
                }
            })

        } else if (mail_reg.test(str)) {
            //判断是邮箱，就通过ajax异步请求给用户的这个邮箱发送验证码
            $.ajax({
                url: "/captcha-code2mail",
                type: "GET",
                async: true,
                data: {email: str},
                dataType: "text",
                success: function () {
                    $('#message').show().css("color", "gray").text("验证码已经发送到您的邮箱,请注意查收！");
                },
                error: function () {
                    $('#message').show().css("color", "#d0393f").text("服务器异常，请重新输入邮箱！");
                }
            })
        } else {
            $('#message').css("color", "#d0393f").show().text("请输入正确的手机号或者邮箱地址");
        }
    })

</script>
</body>
</html>